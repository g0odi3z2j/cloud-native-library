---
title: 流量管理
weight: 4
description: "TSB 中的流量管理和多集群路由。"
---

Tetrate Service Bridge (TSB) 提供强大的流量管理功能，允许有效控制其域内服务之间的流量。TSB 简化了流量路由、分阶段部署和迁移等复杂任务，从而增强了应用程序交付的整体方法。

## TSB 中的网关

![TSB 中的基本应用程序流量。](../../assets/concepts/tsb-traffic-flow.svg)

TSB 使用一系列网关来管理流量路由。当流量进入你的 TSB 环境时，它会在到达其预期应用程序之前遍历各个网关。该过程涉及：

1. 应用程序边缘网关：也称为“边缘网关”，这种共享多租户网关有助于跨集群负载平衡。它将传入流量定向到适当的应用程序入口网关。
2. 应用程序入口网关：称为“应用程序网关”，该网关可以在多个应用程序之间共享，也可以专用于特定应用程序。它控制流量的流动方式以及与应用程序的交互方式。应用程序入口网关归工作区所有，提供对流量的控制。

建议部署多个入口网关以隔离和控制流量。随着时间的推移，随着对网格使用的信心不断增强，可以考虑整合到共享入口网关上。

## 智能流量路由

TSB 通过利用每个集群内本地控制平面的信息来确保智能流量路由。它优先考虑本地流量以获得最佳性能和可用性。Envoy 的按请求功能可以对流量路由进行细粒度控制，支持请求粘性、金丝雀部署以及跨后端均匀分配流量等场景。

TSB 通过本地控制平面跟踪服务可用性、位置和运行状况。这使得系统能够尽可能将流量引导到本地实例。全局控制平面跨集群维护服务信息，实现无缝流量故障转移并增强可用性。

##  多集群路由

![在 us-east 中创建的 bar.com 服务会传播到 TSB，然后通过 XCP 传播到集群。](../../assets/concepts/tsb-bgp.svg)

TSB 擅长管理多集群环境，无论是主动 - 主动还是主动 - 被动配置。多集群管理轻松自如，适合多个集群服务不同团队和应用程序的场景。TSB 使用主机名实现跨集群的无缝应用程序访问，从而促进服务之间的私有通信，无论其集群位置如何。

## API 网关能力无处不在

TSB 将 API 网关功能扩展至整个应用程序流量平台。通过注释 OpenAPI 规范，开发人员可以根据自己的意图配置流量。TSB 跨网关和网格内部实施这些配置，从而提供了规则执行的灵活性。这支持身份验证、授权、速率限制、WAF 策略和通过 WebAssembly (WASM) 进行请求转换等功能。

## 流量分流和迁移

TSB 简化了迁移、流量分割和金丝雀部署的流量管理。该平台使应用程序开发人员能够通过简单的配置过程来改变服务处理流量的方式。TSB 确保安全，使迁移和变更可扩展且易于管理。借助 TSB 的可观测性功能，可以促进可靠的监控和回滚，从而在基础设施转换和更新期间保持应用程序的可用性。

## 结论

Tetrate Service Bridge 的流量管理功能提供对服务如何通信和处理传入请求的精细控制。从网关层次结构到智能流量路由和多集群支持，TSB 简化了复杂环境中的流量管理，增强了应用程序可用性和性能，同时简化了部署流程。
