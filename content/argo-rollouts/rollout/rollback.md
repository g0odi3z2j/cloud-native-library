---
weight: 8
title: "回滚窗口"
date: '2023-06-21T16:00:00+08:00'
type: book
---

🔔 重要提示：自 v1.4 起支持蓝绿部署和金丝雀部署。

默认情况下，当重新应用旧 Rollout 操作时，控制器会像处理规范更改一样处理它，并执行完整的步骤列表，并执行分析。但有两个例外：

1. 控制器检测到正在返回到仍在其 `scaleDownDelay` 范围内且已缩放的蓝绿 ReplicaSet。
2. 控制器检测到正在返回到金丝雀的“稳定”ReplicaSet，并且升级尚未完成。

通常，当期望行为是尽快回滚时，重新运行分析和步骤对于回滚操作来说是不可取的。为了帮助实现这一点，回滚窗口功能允许用户指示在窗口内提升到 ReplicaSet 时将跳过所有步骤。

示例：

```yaml
spec:
  rollbackWindow:
    revisions: 3

  revisionHistoryLimit: 5
```

假设有线性修订历史记录：`1`、`2`、`3`、`4`、`5（当前）`。从修订版本 5 回滚到 4 或 3 将落在窗口内，因此将快速跟踪。
